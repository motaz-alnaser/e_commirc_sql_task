CREATE DATABASE ecommerce_db;


CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(150) UNIQUE NOT NULL
);

CREATE TABLE categories (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL
);


CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(150) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    category_id INT,
    FOREIGN KEY (category_id) REFERENCES categories(id)
);


CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_date DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);


CREATE TABLE order_items (
    id INT PRIMARY KEY AUTO_INCREMENT,
    order_id INT,
    product_id INT,
    quantity INT NOT NULL,
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);


INSERT INTO users (name, email) VALUES
('Ali', 'ali1@mail.com'),
('Sara', 'sara1@mail.com'),
('Ahmad', 'ahmad1@mail.com'),
('Motaz', 'motaz1@mail.com'),
('Saed', 'saed1@mail.com');

INSERT INTO categories (name) VALUES
('Electronics'),
('Clothing'),
('Sports');

INSERT INTO products (name, price, category_id) VALUES
('Laptop', 1000),
('iphon', 1000),
('Laptop', 200),
('T-Shirt', 20),
('Jacket', 50),
('shoes', 30),
('dumbbells', 20);



INSERT INTO orders (user_id, order_date) VALUES
(1, '2025-01-01'),
(2, '2025-01-02'),
(3, '2025-01-03'),
(1, '2025-01-05');


INSERT INTO order_items (order_id, product_id, quantity) VALUES
(1, 1, 1),
(2, 2, 2);


SELECT u.name, o.order_date
FROM users u
INNER JOIN orders o
ON u.id = o.user_id;

SELECT * FROM products
WHERE price > 50
ORDER BY price DESC
LIMIT 2;


SELECT COUNT(*) AS total_orders FROM orders;
SELECT AVG(price) AS avg_price FROM products;



SELECT u.name, o.id AS order_id
FROM users u
LEFT JOIN orders o
ON u.id = o.user_id;

